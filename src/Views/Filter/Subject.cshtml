@model SubjectFilterViewModel

@{
  ViewBag.Title = $"Find courses by subject";
  var selected = Model.FilterModel.SelectedSubjects;
  var isInWizard = ViewBag.IsInWizard == true;
  var errors = ViewBag.Errors as ErrorViewModel;
}


@if(isInWizard) {
  @Html.Partial("Back", new BackLinkViewModel {
    Href = Url.Action("LocationWizard", "Filter", Model.FilterModel.ToRouteValues()),
    Title = "Back to location"
  })
} else {
  @Html.Partial("Back", new BackLinkViewModel {
    Href = Url.Action("Index", "Results", Model.FilterModel.ToRouteValues()),
    Title = "Back to search results"
  })
}

<main class="govuk-main-wrapper" id="main-content" role="main">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      @Html.Partial("Error", errors)
      <div class="govuk-form-group">
        <fieldset class="govuk-fieldset">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--xl">
            <h1 class="govuk-heading-xl">Find courses by subject</h1>
          </legend>
          <p class="govuk-body">Select the subjects you want to teach.</p>
          <p class="govuk-body">You can train to teach a subject even if you don’t have a degree in it, or if you haven’t used your degree knowledge recently. For some subjects you can take a subject knowledge enhancement (SKE) course.</p>
          <p class="govuk-body"><a href="https://getintoteaching.education.gov.uk/explore-my-options/teacher-training-routes/subject-knowledge-enhancement-ske-courses">Find out more about SKE courses on Get into Teaching</a></p>
          <h2 class="govuk-heading-m">Your choice of subject will affect the financial support</h2>
          <p class="govuk-body">For some subjects you could be eligible for up to £28,000 tax-free while you train, through a bursary or scholarship. Alternatively, salaried courses are available in many subjects (salaries start at £16,000). Student finance is available for all subjects.</p>
          <form action='@Url.Action(isInWizard ? "SubjectWizard" : "Subject", "Filter", Model.FilterModel.WithoutSubjects().ToRouteValues())' method="POST" id="subjects-container">
            <div class="accordion" data-module="accordion">
              @foreach (var area in Model.SubjectAreas) {
                <div class="@(" accordion-section " + (@area.Subjects.Any(subject => selected.Contains(subject.Id)) ? "accordion-section--expanded" : " "))">
                  <div class="accordion-section-header">@area.Name</div>
                  <div class="accordion-section-body">
                    <div class="govuk-checkboxes">
                      @foreach (var subject in area.Subjects.OrderBy(x => x.Name)) {
                        <div class="govuk-checkboxes__item">
                          <input id="@("subject- " + subject.Id)" name="SelectedSubjects" type="checkbox" checked="@selected.Contains(subject.Id)" value="@(subject.Id)" class="govuk-checkboxes__input">
                          <label for="@("subject- " + subject.Id)" class="govuk-label govuk-checkboxes__label govuk-label--s">@subject.Name</label>
                        </div>
                      }
                    </div>
                  </div>
                </div>
              }
            </div>
          </fieldset>
        </div>
        <div class="govuk-form-group">
          <input class="govuk-button" type="submit" value="@(isInWizard ? "Continue" : "Find courses")" role="button">
        </div>
      </form>
    </div>
  </div>
</main>
